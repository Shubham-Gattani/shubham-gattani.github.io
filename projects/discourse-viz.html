<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discourse-Viz - Shubham Gattani</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/custom.css">
    <style>
        /* Screenshot Container Styling */
        .screenshot-container {
            margin: 2rem 0;
            padding: 1.5rem;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }

        .screenshot-image {
            width: 100%;
            height: auto;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .screenshot-image:hover {
            transform: scale(1.02);
        }

        .screenshot-caption {
            font-size: 0.95rem;
            color: #7f8c8d;
            margin-bottom: 0;
            font-style: italic;
            border-top: 1px solid #bdc3c7;
            padding-top: 1rem;
        }

        .screenshot-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        /* Gallery Grid for Multiple Screenshots */
        .screenshot-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .gallery-item {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .gallery-item:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .gallery-item img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: block;
        }

        .gallery-item-caption {
            padding: 1rem;
            background-color: #ffffff;
        }

        .gallery-item-caption h5 {
            margin-bottom: 0.5rem;
            color: #2c3e50;
        }

        .gallery-item-caption p {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin: 0;
        }

        /* Expandable Screenshot Modal */
        .modal-body img {
            width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-custom sticky-top">
        <div class="container">
            <a class="navbar-brand" href="../index.html">Shubham Gattani</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"
                    style="background-color: #ecf0f1;">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html#projects">Projects</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html#about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html#contact">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container my-5">

    <!-- ================= Project Header ================= -->
    <section class="mb-5">
      <h1 class="mb-2">Discourse-viz</h1>

      <p class="lead text-muted">
        A Flask web platform that visualizes user engagement metrics across IIT Madras online courses by aggregating Discourse forum activity data with automated daily refresh and trimester-based reset cycles.
      </p>

      <!-- Tech Stack Badges -->
      <div class="mb-3">
        <span class="badge bg-primary">Python</span>
        <span class="badge bg-secondary">Flask</span>
        <span class="badge bg-success">Pandas</span>
        <span class="badge bg-warning text-dark">Altair</span>
        <span class="badge bg-info text-dark">APScheduler</span>
        <span class="badge bg-info text-dark">Google OAuth</span>
        <span class="badge bg-info text-dark">Authlib</span>
        <span class="badge bg-info text-dark">Discourse API</span>
      </div>

      <!-- Links -->
      <div>
        <a href="https://github.com/Shubham-Gattani/discourse-vizz" target="_blank" class="btn btn-outline-dark btn-sm me-2">
          GitHub repo
        </a>
        <!-- <a href="#" target="_blank" class="btn btn-outline-primary btn-sm me-2">
          Live Demo
        </a>
        <a href="#" target="_blank" class="btn btn-outline-secondary btn-sm">
          Slides
        </a> -->
      </div>
    </section>

    <!-- ================= Problem / Context ================= -->
    <section class="mb-5">
      <h3>Problem & Context</h3>
      <p>
        IIT Madras Online Degree programs span multiple courses and trimesters, with students engaging via discourse platform to discuss course content and collaborate. Instructors and administrators needed automated, centralized visibility into top-performing students and course-specific engagement patterns without manual data extraction. This is especially useful to analyse data for those students who are applying for TAship or mentorship for projects. Data refresh requirements differ by situation: full recalculation needed at trimester start-dates to detect new courses/users, while incremental updates are sufficient on regular days.
      </p>
    </section>

    <!-- ================= Your Role ================= -->
    <section class="mb-5">
      <h3>My Role & Scope</h3>
      <ul>
        <li>Built and owned the end-to-end ETL pipeline (load Discourse data, transform with weighted metrics/log-normalized z-scores, and process into course/term user engagement views) with scheduled full resets and daily incremental refresh.</li>
        <li>Designed two-tier data refresh architecture: full system reset on trimester starts (Jan 1, May 1, Sep 1), and incremental daily refresh on all other dates using Background APScheduler</li>
        <li>Implemented multi-level data transformation pipeline: raw event counts (using pivot tables) → unnormalized z-scores → log-normalized z-scores for ranking active users</li>
        <li>Built course-specific and platform-wide engagement analytics using weighted metrics applied to user actions (topics created, replies, solutions, likes given etc)</li>
        <li>Integrated Discourse API query execution layer with pagination, rate-limit retry logic (3s-15s incremental backoff), and structured error handling to surface failures</li>
        <li>Architected role-based user access with Google OAuth (login_required decorators) and structured data isolation across course-term-user hierarchies in nested dictionaries</li>
        <li>Created Altair stacked bar chart visualizations for top-10 active users segmented by engagement type per course and term</li>
      </ul>
    </section>

    <!-- ================= Architecture / Approach ================= -->
    <section class="mb-5">
      <h3>Architecture & Approach</h3>
      <ul>
        <li>Data ingestion tier fetches from Discourse API using 4 parameterized queries</li>
        <li>Global state management stores user_actions_dictionaries keyed by term->subjects->dataframe</li>
        <li>Processor modules apply domain logic: crosstab raw metrics into action counts per user, apply weighted formulas, calculate z-scores, and rank users for visualization</li>
        <li>Routes layer exposes API endpoints (/get_chart, /search_user, /user_details) that select and filter data from global state, triggering chart generation or JSON responses</li>
        <li>Background scheduler enforces single-instance concurrent execution (max_instances=1, coalesce=True) to prevent race conditions on shared data structures</li>
        <li>Logging infrastructure supports both Google Cloud Logging (GCP) for production and console fallback; structured logs include query IDs, terms, course names, and function name for easy debugging</li>
      </ul>
    </section>

    <!-- ================= Key Technical Decisions ================= -->
    <section class="mb-5">
      <h3>Key Technical Decisions</h3>
      <ul>
        <li>
          <strong>Dual-scheduler architecture</strong> (full reset vs. incremental refresh) → <strong>Reason:</strong> To avoid unnecessary full recomputes 99% of days → <strong>Outcome:</strong> ~30min full reset on trimester dates, 5min incremental refreshes on other days
        </li>
        <li>
          <strong>Log-normalized</strong> scores for user ranking instead of raw counts → <strong>Reason:</strong> Log transform reduces outlier bias, especially for individual courses where there are a few super-users which can shadow the contribution of other aspiring users → <strong>Outcome:</strong> top-10 users ranked fairly despite varying activity volume per course
        </li>
        <li>
          <strong>Nested dictionary</strong> keyed by term-course instead of relational database → <strong>Reason:</strong> prototype phase, fast iteration, in-memory access → <strong>Outcome:</strong> simple data slicing for UI
        </li>
        <li>
            <strong>Incremental backoff</strong> retry for Discourse API rate limiting (3s-15s delays) → <strong>Reason: </strong>graceful degradation under high load without data corruption → <strong>Outcome:</strong> reduced failed queries during peak sync windows
        </li>
        <li><strong>State backup</strong> before full system reset with conditional fallback route → <strong>Reason:</strong> reset failures should not break user-facing data access → <strong>Outcome:</strong> users continue seeing previous term data while developers troubleshoot</li>
      </ul>
    </section>

    <!-- ================= Results & Impact ================= -->
    <section class="mb-5">
      <h3>Results & Impact</h3>
      <ul>
        <li>Enabled instructors to identify top-10 active students per course per trimester via interactive stacked bar charts segmented by 6 engagement dimensions (topics created, replies, likes, solutions, days visited)</li>
        <li>Automated end-to-end data refresh pipeline: Eliminated manual Discourse report extraction with scheduled jobs requiring no operator intervention</li>
        <li>Supported course discovery automation: System detects new courses at trimester boundaries, categorizing them against 40+ predefined course listings (Foundation, Diploma, Degree, L4/L5 specializations)</li>
        <li>Integrated multi-stage observability: Structured logging across 6 namespaces (query execution, chart generation, user stats, weekly trends, overall engagement, course-specific) aids rapid incident diagnosis</li>
      </ul>
    </section>

    <!-- ================= Demo Video (Optional) ================= -->
    <!--
    <section class="mb-5">
      <h3>▶ Short Demo (90 seconds)</h3>

      <div class="ratio ratio-16x9">
        <iframe
          src="https://www.youtube.com/embed/YOUR_VIDEO_ID"
          title="Project Demo"
          allowfullscreen>
        </iframe>
      </div>

      <p class="text-muted mt-2">
        Short walkthrough demonstrating core functionality of the app.
      </p>
    </section>
    -->

    <!-- ================= Screenshots ================= -->
    <section class="mb-5">
        <h2>Screenshots & Demo</h2>
        
        <!-- Single Screenshot with Caption -->
        <div class="screenshot-container">
            <div class="screenshot-title">Dashboard Overview</div>
            <img src="../assets/images/project_images/discourse-viz/discourse-viz-dashboard.png" alt="Dashboard Overview" class="screenshot-image" 
                 data-bs-toggle="modal" data-bs-target="#screenshotModal1">
            <p class="screenshot-caption">
                The main dashboard showing real-time student engagement metrics. Users can filter by course and time period to identify engagement across .
            </p>
        </div>

        <!-- Gallery of Multiple Screenshots -->
        <div class="screenshot-gallery">
            <div class="gallery-item">
                <img src="../assets/images/project_images/discourse-viz/weekwise-engagement-chart.png" alt="weekwise-engagement-chart" 
                     data-bs-toggle="modal" data-bs-target="#screenshotModal2" style="cursor: pointer;">
                <div class="gallery-item-caption">
                    <h5>Analytics Panel</h5>
                    <p>Detailed breakdown of weekwise engagement trends and patterns</p>
                </div>
            </div>

            <div class="gallery-item">
                <img src="../assets/images/project_images/discourse-viz/most-freq-first-respnders.png" alt="First responders" 
                     data-bs-toggle="modal" data-bs-target="#screenshotModal3" style="cursor: pointer;">
                <div class="gallery-item-caption">
                    <h5>Advanced metrics</h5>
                    <p>Tracking students which were the first to respond to a new topic -> strong contenders for becoming TA in the course</p>
                </div>
            </div>

            <div class="gallery-item">
                <img src="../assets/images/project_images/discourse-viz/trending-topics.png" alt="trending-topics" 
                     data-bs-toggle="modal" data-bs-target="#screenshotModal4" style="cursor: pointer;">
                <div class="gallery-item-caption">
                    <h5>Trending Topics</h5>
                    <p>Course instructors can find trending topics so that they can respond effectively to student interests and concerns.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- ================= Future Improvements ================= -->
    <section class="mb-5">
      <h3>What I'd improve in future</h3>
      <ul>
        <li>Migrate state management from in-memory nested dictionaries to Redis cache or just store them in GCS bucket as a pickle file: enable horizontal scaling, support multiple app instances, persist state across deployments (at present, the max number of concurrent users is ~50, so we would need to make these changes only when this number goes above 100)</li>
        <li>Implement incremental database storage of query results: avoid redundant Discourse API calls, enable historical trend analysis beyond current 3-trimester window.</li>
      </ul>
    </section>

    <!-- ================= Back Link ================= -->
    <section>
        <a href="../index.html#projects" class="btn btn-primary">← Back to Projects</a>
    </section>

  </div>

  <!-- Screenshot Modal for Enlarged View -->
  <div class="modal fade" id="screenshotModal1" tabindex="-1" aria-labelledby="screenshotLabel1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="screenshotLabel1">Dashboard Overview</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <img src="../assets/images/project_images/discourse-viz/discourse-viz-dashboard.png" alt="Dashboard Overview">
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="screenshotModal2" tabindex="-1" aria-labelledby="screenshotLabel2" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="screenshotLabel2">weekwise-engagement-chart</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <img src="../assets/images/project_images/discourse-viz/weekwise-engagement-chart.png" alt="weekwise-engagement-chart">
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="screenshotModal3" tabindex="-1" aria-labelledby="screenshotLabel3" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="screenshotLabel3">First responders</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <img src="../assets/images/project_images/discourse-viz/most-freq-first-respnders.png" alt="First responders">
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="screenshotModal4" tabindex="-1" aria-labelledby="screenshotLabel4" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="screenshotLabel4">Trending-topics</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <img src="../assets/images/project_images/discourse-viz/trending-topics.png" alt="trending-topics">
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>
